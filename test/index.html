<!DOCTYPE html><meta charset=utf-8 /><title>Coco Tests</title
><link rel=stylesheet href=../doc/doc.css
><link rel=icon       href=../coco.png
><style>
#stdout {font:bold medium monospace; margin:2ex 1em 0}
</style

><pre id=stdout></pre

><script>sources=[
'assignment',
'chaining',
'comments',
'compilation',
'existence',
'functions',
'if',
'literals',
'loop',
'oo',
'operations',
'regexps',
'splats',
'strings',
'switch',
'try'
]</script
><script type=coco>
start   = new Date
stdout  = document.getElementById 'stdout'
success = total = done = failed = 0

say = (msg, yay) ->
  div = document.createElement 'div'
  div.appendChild document.createTextNode msg
  div.style.color = if yay then 'green' else 'red'
  stdout.appendChild div
  msg

@ok = (good, msg) ->
  ++total
  if good then ++success else throw Error say msg

@eq = (x, y, msg) -> ok x is y, msg ? x + ' !== ' + y

@throws = (msg, fun) ->
  try do fun catch e then return eq e.message, msg
  ok false, 'should throw: ' + msg

Coco.run = (code, cb) ->
  try Function(Coco.compile code, bare: true).call self
  catch e then cb(); throw e
  cb true

run = (name) ->
  Coco.load name + '.co', (yay) ->
    say "#{ if yay then '\u2714' else '\u3000' } #{name}", yay
    ++failed unless yay
    fin() if ++done is sources.length

fin = ->
  yay = success is total and not failed
  sec = (new Date - start) / 1e3
  msg = "passed #{success} tests in #{ sec.toFixed 2 } seconds"
  msg = "failed #{ total - success } tests and #{msg}" unless yay
  say msg, yay

run name for name of sources
</script
><script src=../extras/coco.js></script
><script src=../doc/showdown.js></script
><script src=../doc/prettify.js></script
><script src=../doc/lang-co.js></script
><script src=../doc/doc.js></script>
